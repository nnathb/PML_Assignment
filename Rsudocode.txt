library(caret)
wldata <- read.csv(file="pml-training.csv")

#PCA/GLM model construction from selected features
#Cross validation sampling - 1

set.seed(33456)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

preProc <- preProcess( train_set[,-42],method="pca")
trainPC <- predict(preProc,train_set[,-42])
modelFitPCA <- train(train_set$classe ~ .,method="glm",data=trainPC)

testPC <- predict(preProc,test_set[,-42])
confusionMatrix(test_set$classe,predict(modelFitPCA,testPC))

#PCA/GLM model construction from selected features
#Cross validation sampling - 2

set.seed(5567)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

preProc <- preProcess( train_set[,-42],method="pca")
trainPC <- predict(preProc,train_set[,-42])
modelFitPCA <- train(train_set$classe ~ .,method="glm",data=trainPC)

testPC <- predict(preProc,test_set[,-42])
confusionMatrix(test_set$classe,predict(modelFitPCA,testPC))

#PCA/GLM model construction from selected features
#Cross validation sampling - 3

set.seed(13245)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

preProc <- preProcess( train_set[,-42],method="pca")
trainPC <- predict(preProc,train_set[,-42])
modelFitPCA <- train(train_set$classe ~ .,method="glm",data=trainPC)

testPC <- predict(preProc,test_set[,-42])
confusionMatrix(test_set$classe,predict(modelFitPCA,testPC))

#PCA/GLM model construction from selected features
#Cross validation sampling - 4

set.seed(1125)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

preProc <- preProcess( train_set[,-42],method="pca")
trainPC <- predict(preProc,train_set[,-42])
modelFitPCA <- train(train_set$classe ~ .,method="glm",data=trainPC)

testPC <- predict(preProc,test_set[,-42])
confusionMatrix(test_set$classe,predict(modelFitPCA,testPC))

#############
#Classification Tree model construction from selected features
#Cross validation sampling - 1

set.seed(53748)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

modFit <- train(classe ~ .,method="rpart",data=train_set)

print(modFit$finalModel)

preTree <- predict(modFit,newdata=test_set)
confusionMatrix(test_set$classe,preTree)

#Classification Tree model construction from selected features
#Cross validation sampling - 2

set.seed(64785)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

modFit <- train(classe ~ .,method="rpart",data=train_set)

print(modFit$finalModel)

preTree <- predict(modFit,newdata=test_set)
confusionMatrix(test_set$classe,preTree)

#Classification Tree model construction from selected features
#Cross validation sampling - 3

set.seed(4758)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

modFit <- train(classe ~ .,method="rpart",data=train_set)

print(modFit$finalModel)

preTree <- predict(modFit,newdata=test_set)
confusionMatrix(test_set$classe,preTree)

#Classification Tree model construction from selected features
#Cross validation sampling - 4

set.seed(5)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

modFit <- train(classe ~ .,method="rpart",data=train_set)

print(modFit$finalModel)

preTree <- predict(modFit,newdata=test_set)
confusionMatrix(test_set$classe,preTree)

##################
#Random Forest
#Cross validation sampling - 1

set.seed(645)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

modFit_rf <- train(classe~ .,data=train_set,method="rf",prox=TRUE)

pred_fr <- predict(modFit_rf,test_set) 
confusionMatrix(test_set$classe,pred_fr)

#Random Forest
#Cross validation sampling - 2

set.seed(6748)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

modFit_rf2 <- train(classe~ .,data=train_set,method="rf",prox=TRUE)

pred_rf2 <- predict(modFit_rf2,test_set) 
confusionMatrix(test_set$classe,pred_rf2)

#Random Forest
#Cross validation sampling - 3

set.seed(2424)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

modFit_rf3 <- train(classe~ .,data=train_set,method="rf",prox=TRUE)

pred_rf3 <- predict(modFit_rf3,test_set) 
confusionMatrix(test_set$classe,pred_rf3)

#Random Forest
#Cross validation sampling - 4

set.seed(5142)

inTrain <- createDataPartition(y=wldata$classe, p=0.60, list=FALSE)
train_set <- wldata[inTrain,SelectedFeatures]
test_set <- wldata[-inTrain,SelectedFeatures]

modFit_rf4 <- train(classe~ .,data=train_set,method="rf",prox=TRUE)

pred_rf4 <- predict(modFit_rf4,test_set) 
confusionMatrix(test_set$classe,pred_rf4)
